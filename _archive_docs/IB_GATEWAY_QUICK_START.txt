#!/bin/bash
# Quick reference for IB Gateway Headless Setup on Linux

cat << 'QUICK_REF'

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘          IB GATEWAY HEADLESS SETUP - QUICK REFERENCE                 â•‘
â•‘          Linux | TWS API | No GUI Required                           â•‘
â•‘          PIN: 841921                                                 â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
 âš¡ COMPLETE SETUP (1 COMMAND)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

  bash /home/ing/RICK/RICK_LIVE_CLEAN/scripts/setup_ib_gateway_headless.sh

After this runs, you get:
  âœ… IB Gateway installed
  âœ… Headless startup script
  âœ… Python test script
  âœ… Systemd service
  âœ… Monitoring tools

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
 ðŸš€ STARTUP SEQUENCE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. Start IB Gateway (headless)
   ~/.local/bin/start_ib_gateway
   
   Expected output:
   âœ… IB Gateway started (PID: 12345)

2. Wait 5 seconds for startup

3. Test connection
   ~/.local/bin/test_ib_connection
   
   Expected output:
   âœ… PIN verified: 841921
   âœ… Connected!
   ðŸ“Š Account ID: DU6880040
      Balance: $50,000.00

4. Start monitoring dashboard
   cd /home/ing/RICK/RICK_LIVE_CLEAN
   python3 dashboard/app.py

5. Open browser
   http://127.0.0.1:8080

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
 ðŸ” VERIFICATION COMMANDS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Is gateway running?
  lsof -i :4002

View gateway logs
  tail -f ~/Jts/ib_gateway.log

Monitor status (realtime)
  ~/.local/bin/ib_monitor
  
OR watch status
  watch -n 1 'lsof -i :4002'

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
 ðŸ›‘ STOP/RESTART
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Stop gateway
  pkill ibgateway

Restart gateway
  pkill ibgateway
  sleep 2
  ~/.local/bin/start_ib_gateway

Stop via systemd (if service is running)
  systemctl --user stop ib-gateway

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
 ðŸ“‹ PORT MAPPING
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Paper Trading
  Port: 4002
  Account: DU6880040 (default)
  Real Money: NO
  Use For: Testing, validation, learning

Live Trading
  Port: 4001
  Account: Your live IB account
  Real Money: YES
  Use For: REAL TRADING (PIN protected)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
 ðŸ” SECURITY
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

PIN: 841921 (Charter verified)
  - Required for any broker instantiation
  - Validated in IBConnector.__init__()
  - Prevents unauthorized trading

Order Guardian Gating
  - All orders pass through Position Guardian
  - 7 rule systems enforced:
    âœ… Correlation (< 0.70)
    âœ… Margin (< 60%)
    âœ… Volatility (no bad times)
    âœ… Notional ($15K minimum)
    âœ… Hedging (auto-applied)
    âœ… Session (respects hours)
    âœ… Post-trade (auto-BE, trailing, scale)

Narration Logging
  - All operations logged to audit trail
  - View with: tail -f logs/narration.jsonl
  - Proof of compliance

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
 ðŸ› TROUBLESHOOTING
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Q: "Connection refused" on port 4002
A: Gateway not running
   Fix: ~/.local/bin/start_ib_gateway

Q: "API not enabled"
A: TWS settings need update
   Fix: First time only:
        1. Start GUI: ~/Jts/ibgateway/*/ibgateway
        2. Login with IB credentials
        3. Configure â†’ Settings â†’ API â†’ Settings
        4. Check "Enable ActiveX and Socket Clients"
        5. Save, then use headless mode

Q: "ib_insync not installed"
A: Python library missing
   Fix: pip install ib_insync

Q: Python test fails but gateway is running
A: Socket connection issue
   Fix: 1. Check port: lsof -i :4002
        2. Check logs: tail ~/Jts/ib_gateway.log
        3. Restart: pkill ibgateway && ~/.local/bin/start_ib_gateway

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
 ðŸ“‚ KEY FILES
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Setup script
  /home/ing/RICK/RICK_LIVE_CLEAN/scripts/setup_ib_gateway_headless.sh

Starter script (after setup)
  ~/.local/bin/start_ib_gateway

Test script (verify connection)
  ~/.local/bin/test_ib_connection

Monitor script (real-time status)
  ~/.local/bin/ib_monitor

Python connector
  /home/ing/RICK/RICK_LIVE_CLEAN/brokers/ib_connector.py

Configuration
  ~/Jts/ibgateway_config.ini
  /home/ing/RICK/RICK_LIVE_CLEAN/env_new2.env

Logs
  ~/Jts/ib_gateway.log
  /home/ing/RICK/RICK_LIVE_CLEAN/logs/narration.jsonl

Documentation
  /home/ing/RICK/RICK_LIVE_CLEAN/IBKR_HEADLESS_GATEWAY_LINUX_CONFIRMATION.md

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
 âœ… SUCCESS CHECKLIST
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

After setup:
  â˜‘ IB Gateway installed at ~/Jts/ibgateway
  â˜‘ Startup script at ~/.local/bin/start_ib_gateway
  â˜‘ Test script at ~/.local/bin/test_ib_connection
  â˜‘ Monitor script at ~/.local/bin/ib_monitor
  â˜‘ Config at ~/Jts/ibgateway_config.ini
  â˜‘ Systemd service created (optional)

After startup:
  â˜‘ Gateway running on port 4002
  â˜‘ Can connect from Python
  â˜‘ Account info retrievable
  â˜‘ Positions visible
  â˜‘ Orders can be placed (through guardian)

After integration:
  â˜‘ Dashboard shows IB status
  â˜‘ Pointers feed updating every 15s
  â˜‘ Orders routing through guardian
  â˜‘ Narration logging working
  â˜‘ All broker integrations active (OANDA/Coinbase/IB)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
 ðŸŽ¯ TIMELINE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Time          Action
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 0:00-0:05    Run setup script
 0:05-0:06    Start IB Gateway
 0:06-0:08    Wait for startup
 0:08-0:09    Test connection
 0:09-0:14    Review dashboard
 0:14+        Ready to trade!

Total: ~15 minutes from start to live trading

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
 ðŸš€ YOU'RE READY!
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

IB Gateway Headless is:
  âœ… Configured for Linux
  âœ… No GUI required
  âœ… Fully automated startup
  âœ… PIN protected (841921)
  âœ… Guardian gated (7 rule systems)
  âœ… Integrated with monitoring
  âœ… Multi-broker ready (OANDA/Coinbase/IB)
  âœ… Production ready

Next command:
  bash /home/ing/RICK/RICK_LIVE_CLEAN/scripts/setup_ib_gateway_headless.sh

Then:
  ~/.local/bin/start_ib_gateway
  ~/.local/bin/test_ib_connection
  cd /home/ing/RICK/RICK_LIVE_CLEAN && python3 dashboard/app.py

Then: Open http://127.0.0.1:8080 and start trading!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

QUICK_REF
